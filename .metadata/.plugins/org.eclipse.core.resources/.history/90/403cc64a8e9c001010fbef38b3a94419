
#include "Simu.h"

#include "DhoCommun.h"
#include "xml_utils.h"

const char* filename_Vbm = "data.xml";
const char* filename_Fum = "data_Fum.xml";
const char* filename_Lim = "data_Lim.xml";


EemStates currentEemState = ST_GeneratorOn;
bool flagDiag = true;

int main() {
    start_xml(filename_Vbm);
    start_xml(filename_Fum);
    start_xml(filename_Lim);

    VbmInit();
    FumInit();
    LimInit();

    CAN_Bus bus;
    can_bus_init(&bus);
    can_bus_register(&bus, node_receive);

    while (true) {
        usleep(100000); // 100 ms
        Vbm_step50ms();
        Fum_step50ms();
        Lim_step50ms();
    }
}
